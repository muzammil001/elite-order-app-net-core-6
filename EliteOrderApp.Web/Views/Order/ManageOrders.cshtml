@{
	ViewData["Title"] = "Manage Orders";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- [ breadcrumb ] start -->
<div class="page-header">
	<div class="page-block">
		<div class="row align-items-center">
			<div class="col-md-12">
				<div class="page-header-title">
					<h3 class="m-b-10">Manage Orders</h3>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- [ breadcrumb ] end -->

<div class="main-body">
	<div class="page-wrapper">
		<table id="orders" class="display table  compact ">
			<thead>
				<tr>
					<th>Order Date</th>
					<th>Delivery Date</th>
					<th>Customer Name</th>
					<th>Customer Contact</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
			<tfoot>
			</tfoot>
		</table>
	</div>

</div>


@section Scripts
{
	<script>
		$(document).ready(function() {
			const cols = [
				{
					data: "orderDate",
					render: function(data) {
						const date = new Date(data);
						const month = date.getMonth() + 1;
						return (month.toString().length > 1 ? month : "0" + month) + "/" + date.getDate() + "/" + date.getFullYear();
					}
				},
				{
					data: "deliveryDate",
					render: function(data) {
						const date = new Date(data);
						const month = date.getMonth() + 1;
						return (month.toString().length > 1 ? month : "0" + month) + "/" + date.getDate() + "/" + date.getFullYear();
					}
				},
				{
					data: "customer.name"
				},
				{
					data: "customer.contact"
				},
				{
					data: "id",
					render: function(data) {
						return `<button type="button" class="btn btn-icon btn-rounded btn-primary" data-orderItem-id=${data} title='View Invoice'><i class="feather icon-file-text"></i></button>`
							+ `<a href="/Order/EditOrder/${data}" type="button" class="btn btn-icon btn-rounded btn-info" title='Edit Order'><i class="feather icon-edit"></i></a>`
							+ `<button type="button" class="btn btn-icon btn-rounded btn-info" data-orderItem-id=${data} title='Payment History'><i class="fas fas fa-money-bill-alt"></i></button>`
							+ `<button type="button" class="btn btn-icon btn-rounded btn-danger js-delete-order" data-orderItem-id=${data} title='Delete Order'><i class="feather icon-trash"></i></button>`;
					}
				}
			];


			const table = getTable("orders", "/api/orders/get-pending-orders", cols, false);
			deleteRecord("orders", ".js-delete-order", "/api/orders/delete-customer/", "data-orderItem-id", table);

		});

	</script>
}
